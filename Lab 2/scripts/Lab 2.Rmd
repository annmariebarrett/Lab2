---
title: "EDLD 2 - Lab 2"
author: "Ann-Marie Barrett, Raleigh Goodwin, Kavya Mudiam, Zachary Schroeder,  Vinita Vader"
date: "January 2021"
output: html_document
editor_options: 
  chunk_output_type: inline
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(fivethirtyeight)
library(fivethirtyeightdata)
library(tidyverse)
library(lubridate)

```

# #1
```{r}
google_trends <- data.frame(google_trends)

# Pivoting data long to make easier to plot
google_trends_long <- google_trends %>% 
  mutate(Harvey = hurricane_harvey_us,
         Irma = hurricane_irma_us,
         Maria = hurricane_maria_us,
         Jose = hurricane_jose_us) %>% 
  select(date, Harvey, Irma, Maria, Jose)

google_trends_long <- gather(google_trends_long, "Hurricane", "Articles", Harvey:Jose, factor_key = T)

# First visualization

google_trends_long %>% 
  ggplot(aes(date, Articles)) + 
  geom_line(aes(color = Hurricane)) +
  labs(title = "2017 Hurricane Season Google Trends",
       x = "Date") + #tbh I'm not totally sure what the y axis represents lol
  theme_minimal()

# Visualization with solid shapes

plot <- google_trends_long %>% 
  ggplot(aes(date, Articles)) + 
  geom_ribbon(aes(ymin = 0, ymax = Articles, 
                  fill = Hurricane),
              alpha = .7) +
  labs(title = "2017 Hurricane Season Google Trends",
       x = "Date") +
  theme_minimal()

# Same relation but color continuous

google_trends_long %>% 
  #group_by(Hurricane, date) %>% 
  ggplot(aes(date, Hurricane)) +
  geom_tile(aes(fill = Articles), 
            color = "white") +
  coord_fixed() +
  scale_fill_viridis_c(direction = -1, option = "plasma")

# Landfall dates included

google_trends_landfall <- tibble(
  landfall = c(ymd(20170825), ymd(20170910), ymd(20170920)),
  storm = c("Harvey", "Irma", "Maria")
  )

plot + 
  geom_vline(data = google_trends_landfall, aes(xintercept = landfall))



# Final modifications
#ideas: center Title, specify Y axis label, 

```

